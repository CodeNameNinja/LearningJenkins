<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Tutorial: Docker and Jenkins - SSH-III</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Tutorial: Docker and Jenkins - SSH-III</h1>

    <section>

<header>
    

    <h2>Docker and Jenkins - SSH-III</h2>
</header>

<article>
    <h3>Finish Configuration for your SSH server</h3>
<p>lets edit our docker-compose file again with</p>
<p><code>vi docker-compose.yml</code></p>
<p>and let us make a few changes.</p>
<p>Firstly we need to create your new service <code>remote-host</code> and specify the image, we can name it what we like as we are going to make our own image, so for example I chose <code>remote-host</code>, and we need to specify the <code>build</code> <code>context</code> in our case that would be in your container called <code>centor7</code></p>
<p>and then lastly add it to the network as we did with our jenkins service.</p>
<pre class="prettyprint source lang-bash"><code>
version: '3'
services:
  jenkins:
    container_name: jenkins
    image: jenkins/jenkins
    ports:
      - '8080:8080'
    volumes:
      - &quot;$PWD/jenkins_home:/var/jenkins_home&quot;
    networks:
      - net
  remote_host:
   tty: true
   container_name: remote-host
   image: remote-host
   build:
    context: centos7
   networks:
      - net
networks:
  net:

</code></pre>
<p>lets build it!</p>
<p><code>docker-compose build</code></p>
<p>if everything is correct, we should see a message like this:</p>
<p><img src="https://i.ibb.co/6FmnDCP/Screenshot-2021-08-20-123242.png" alt="Build Succesfull remote-host:latest"></p>
<p>To verify this, we can use <code>docker image</code> and you should see our newly created docker image</p>
<p><img src="https://i.ibb.co/wYqjgF3/Screenshot-2021-08-20-123518.png" alt="Docker image: remote-host"></p>
<p>Great!</p>
<p>Now lets spin up the containers with</p>
<p><code>docker-compose up -d</code></p>
<p>and we should see both remote-host and jenkins contains running.</p>
<p>now lets get into our jenkins container and ssh into our remote_host container</p>
<blockquote>
<p>first get into bash in remote_host if you get permissions errors and remove this file</p>
<pre class="prettyprint source lang-bash"><code>ls -l /run/nologin
rm /run/nologin
</code></pre>
</blockquote>
<p><code>docker exec -ti jenkins bash</code></p>
<p>and then connect to remote host with our remote_user</p>
<pre class="prettyprint source lang-bash"><code>ssh remote_user@remote_host
</code></pre>
<p>and type <code>yes</code> to allow ssh key to be added to known hosts.</p>
<p>lets verify that we can connect to our remote_host from our jenkins container.</p>
<p><code>exit</code>
and we should be back to our normal directory. lets go into our <code>centos7</code> directory and copy our remote-key to our jenkins containers.</p>
<p><code>docker cp remote-key jenkins:/tmp/remote-key</code></p>
<p>lets get into your jenkins container by running</p>
<pre class="prettyprint source lang-bash"><code>docker exec -it jenkins /bin/bash

cd tmp/


</code></pre>
<p><img src="https://i.ibb.co/SNHGZv6/Screenshot-2021-08-21-173949.png" alt="remote-key in tmp folder"></p>
<p>now let's use it:</p>
<pre class="prettyprint source lang-bash"><code>ssh -i remote-key remote_user@remote_host
</code></pre>
<p>and we should be able to log in without any password.</p>
</article>

</section>

</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Tutorials</h3><ul><li><a href="tutorial-getting-started-with-jenkins.html">Getting Started with Jenkins</a></li><li><a href="tutorial-Jenkins-And-Docker.html">Jenkins and Docker</a></li><li><a href="tutorial-jenkins-basics.html">Jenkins Basics</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.7</a> on Sat Aug 21 2021 17:52:37 GMT+0200 (South Africa Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>